<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>จัดการเจ้าหน้าที่</title>
    <link rel="shortcut icon" type="image/png" href="http://www.bhwelder.com.my/img/hotproduct.png" />
    <!-- Main CSS-->
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <!-- Font-icon css-->
    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS"
        crossorigin="anonymous">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS"
        crossorigin="anonymous">
</head>

<body class="app sidebar-mini rtl">
    <!-- Navbar-->
    <header class="app-header"><a class="app-header__logo" href="index.html">ASAP</a>
        <!-- Sidebar toggle button--><a class="app-sidebar__toggle" href="#" data-toggle="sidebar" aria-label="Hide Sidebar"></a>
        <!-- Navbar Right Menu-->
        <ul class="app-nav">
            <li class="app-search">
                <input class="app-search__input" type="search" placeholder="Search">
                <button class="app-search__button"><i class="fa fa-search"></i></button>
            </li>

            <!-- User Menu-->
            <li class="dropdown"><a class="app-nav__item" href="#" data-toggle="dropdown" aria-label="Open Profile Menu"><i
                        class="fa fa-user fa-lg"></i></a>
                <ul class="dropdown-menu settings-menu dropdown-menu-right">
                    <li><a class="dropdown-item" href="#"><i class="fa fa-cog fa-lg"></i> Settings</a></li>
                    <li><a class="dropdown-item" href="#"><i class="fa fa-user fa-lg"></i> Profile</a></li>
                    <li><a class="dropdown-item" href="login"><i class="fa fa-sign-out fa-lg"></i> Logout</a>
                    </li>
                </ul>
            </li>
        </ul>
    </header>
    <!-- Sidebar menu-->
    <div class="app-sidebar__overlay" data-toggle="sidebar"></div>
    <aside class="app-sidebar">
        <div class="app-sidebar__user"><img class="app-sidebar__user-avatar" src="https://www.img.in.th/images/907a16df723b68dd9b01785c32ef6a28.jpg"
                alt="User Image" height="48px" width="48">
            <div>
                <p class="app-sidebar__user-name">ภัทรดนัย ช่างเหลา</p>
                <p class="app-sidebar__user-designation">สถานะ : Admin</p>
            </div>
        </div>
        <ul class="app-menu">
            <li><a class="app-menu__item" href="#"><i class="app-menu__icon fa fa-podcast"></i><span class="app-menu__label">ประกาศ</span></a></li>
            <li class="treeview"><a class="app-menu__item" href="#" data-toggle="treeview"><i class="app-menu__icon fa fa-laptop"></i><span
                        class="app-menu__label">จัดการบุคลากร</span><i class="treeview-indicator fa fa-angle-right"></i></a>
                <ul class="treeview-menu">
                    <li><a class="treeview-item" href="#"><i class="icon fa fa-cogs"></i>
                            จัดการเจ้าหน้าที่</a></li>
                    <li><a class="treeview-item" href="#" rel="noopener"><i class="icon fa fa-cogs"></i>
                            จัดการอาจารย์</a></li>
                    <li><a class="treeview-item" href="#"><i class="icon fa fa-cogs"></i>จัดการนิสิต</a></li>
                </ul>
            </li>
            <li><a class="app-menu__item" href="#"><i class="app-menu__icon fa fa-sun-o"></i><span class="app-menu__label">จัดการการสอบ</span></a></li>
            <li><a class="app-menu__item" href="#"><i class="app-menu__icon fa fa-sun-o"></i><span class="app-menu__label">จัดการรายวิชา</span></a></li>
            <li><a class="app-menu__item" href="#"><i class="app-menu__icon fa fa-sun-o"></i><span class="app-menu__label">จัดการตึก</span></a></li>
        </ul>
    </aside>

    <!-- Modal -->
    <div class="modal fade" id="EditModalCenter" tabindex="-1" role="dialog" aria-labelledby="EditModalCenter"
        aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="EditModalCenter">แก้ไขข้อมูลเจ้าหน้าที่</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text" id="inputGroup-sizing-default">ID</span>
                        </div>
                        <input type="text" id="editid" class="form-control" aria-label="Sizing example input"
                            aria-describedby="inputGroup-sizing-default">
                    </div>
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text" id="inputGroup-sizing-default">ชื่อผู้ใช้งาน</span>
                        </div>
                        <input type="text" id="editusername" class="form-control" aria-label="Sizing example input"
                            aria-describedby="inputGroup-sizing-default">
                    </div>
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text" id="inputGroup-sizing-default">รหัสผ่าน</span>
                        </div>
                        <input type="text" id="editpassword" class="form-control" aria-label="Sizing example input"
                            aria-describedby="inputGroup-sizing-default">
                    </div>
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text" id="inputGroup-sizing-default">ชื่อ</span>
                        </div>
                        <input type="text" id="editfirstname" class="form-control" aria-label="Sizing example input"
                            aria-describedby="inputGroup-sizing-default">
                    </div>
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text" id="inputGroup-sizing-default">นามสกุล</span>
                        </div>
                        <input type="text" id="editlastname" class="form-control" aria-label="Sizing example input"
                            aria-describedby="inputGroup-sizing-default">
                    </div>
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text" id="inputGroup-sizing-default">อีเมล</span>
                        </div>
                        <input type="text" id="editemail" class="form-control" aria-label="Sizing example input"
                            aria-describedby="inputGroup-sizing-default">
                    </div>

                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <label class="input-group-text" for="inputGroupSelect01">สถานะผู้ใช้งาน</label>
                        </div>
                        <select class="custom-select" id="editstatus">
                            <option selected>โปรดเลือก...</option>
                            <option value="เจ้าหน้าที่วิชาการ">เจ้าหน้าที่วิชาการ</option>
                            <option value="นิสิต">นิสิต</option>
                            <option value="อาจารย์">อาจารย์</option>
                            <option value="เจ้าหน้าที่ทั่วไป">เจ้าหน้าที่ทั่วไป</option>
                        </select>
                    </div>

                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text" id="inputGroup-sizing-default">ตำแหน่ง</span>
                        </div>
                        <input type="text" id="editposition" class="form-control" aria-label="Sizing example input"
                            aria-describedby="inputGroup-sizing-default">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">ยกเลิก</button>
                    <button onclick="editPerson()" type="button" class="btn btn-primary">ยืนยัน</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Modal เพิ่ม -->
    <div class="modal fade" id="AddModalCenter" tabindex="-1" role="dialog" aria-labelledby="AddModalCenter"
        aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="AddModalCenter">เพิ่มข้อมูลเจ้าหน้าที่</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text" id="inputGroup-sizing-default">ID</span>
                        </div>
                        <input type="text" id="id" class="form-control" aria-label="Sizing example input"
                            aria-describedby="inputGroup-sizing-default">
                    </div>
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text" id="inputGroup-sizing-default">ชื่อผู้ใช้งาน</span>
                        </div>
                        <input type="text" id="username" class="form-control" aria-label="Sizing example input"
                            aria-describedby="inputGroup-sizing-default">
                    </div>
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text" id="inputGroup-sizing-default">รหัสผ่าน</span>
                        </div>
                        <input type="text" id="password" class="form-control" aria-label="Sizing example input"
                            aria-describedby="inputGroup-sizing-default">
                    </div>
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text" id="inputGroup-sizing-default">ชื่อ</span>
                        </div>
                        <input type="text" id="firstname" class="form-control" aria-label="Sizing example input"
                            aria-describedby="inputGroup-sizing-default">
                    </div>
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text" id="inputGroup-sizing-default">นามสกุล</span>
                        </div>
                        <input type="text" id="lastname" class="form-control" aria-label="Sizing example input"
                            aria-describedby="inputGroup-sizing-default">
                    </div>
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text" id="inputGroup-sizing-default">อีเมล</span>
                        </div>
                        <input type="text" id="email" class="form-control" aria-label="Sizing example input"
                            aria-describedby="inputGroup-sizing-default">
                    </div>

                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <label class="input-group-text" for="status">สถานะผู้ใช้งาน</label>
                        </div>
                        <select class="custom-select" id="status">
                            <option selected>โปรดเลือก...</option>
                            <option value="เจ้าหน้าที่วิชาการ">เจ้าหน้าที่วิชาการ</option>
                            <option value="นิสิต">นิสิต</option>
                            <option value="อาจารย์">อาจารย์</option>
                            <option value="เจ้าหน้าที่ทั่วไป">เจ้าหน้าที่ทั่วไป</option>
                        </select>
                    </div>

                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text" id="inputGroup-sizing-default">ตำแหน่ง</span>
                        </div>
                        <input type="text" id="position" class="form-control" aria-label="Sizing example input"
                            aria-describedby="inputGroup-sizing-default">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">ยกเลิก</button>
                    <button onclick="addOfficial()" type="button" class="btn btn-primary">ยืนยัน</button>
                </div>
            </div>
        </div>
    </div>

    <!-- End Modal -->

    <main class="app-content">
        <div class="app-title">
            <div>
                <h1><i class="fa fa-th-list"></i> จัดการเจ้าหน้าที่</h1>

                <p>เพิ่ม ลบ แก้ไข เจ้าหน้าที่</p>
            </div>
            <ul class="app-breadcrumb breadcrumb side">
                <li class="breadcrumb-item"><i class="fa fa-home fa-lg"></i></li>
                <li class="breadcrumb-item">Tables</li>
                <li class="breadcrumb-item active"><a href="#">Data Table</a></li>

            </ul>
        </div>
        <div class="row">
            <div class="col-md-12">
                <div class="tile">
                    <div class="tile-body">
                            <button type="button" class="btn btn-outline-success btn-block" style="font-size: 15px; width: 5%; float: right;"
                            data-toggle="modal" data-toggle="modal" data-target="#AddModalCenter">เพิ่ม</button>
                        <table class="table table-hover table-bordered" id="sampleTable">
                            <thead>
                                <tr>
                                    <th>ชื่อผู้ใช้งาน</th>
                                    <th>ชื่อ</th>
                                    <th>นามสกุล</th>
                                    <th>อีเมล</th>
                                    <th>ลบ</th>
                                    <th>แก้ไข</th>
                                    <!-- <th>เพิ่ม</th> -->
                                </tr>
                            </thead>
                            <tbody>
                                <% for(var i=0; i < persons.length; i++) { %>
                                <tr>
                                    <td>
                                        <%= persons[i].username %>
                                    </td>
                                    <td>
                                        <%= persons[i].firstname %>
                                    </td>
                                    <td>
                                        <%= persons[i].lastname %>
                                    </td>
                                    <td>
                                        <%= persons[i].email %>
                                    </td>

                                    <td>
                                        <button onclick="deletePerson('<%= persons[i].id %>')" type="button" class="btn btn-outline-danger btn-block"
                                            style="font-size: 15px;">ลบ</button>
                                    </td>
                                    <td>
                                        <button onclick="feedPerson('<%= persons[i].id %>','<%= persons[i].username %>','<%= persons[i].password %>','<%= persons[i].firstname %>'
                                        ,'<%= persons[i].lastname %>','<%= persons[i].email %>','<%= persons[i].status %>','<%= persons[i].position %>')"
                                            type="button" class="btn btn-outline-warning btn-block" style="font-size: 15px;"
                                            data-toggle="modal" data-toggle="modal" data-target="#EditModalCenter" )">แก้ไข</button>
                                    </td>
                                    <!-- <td>
                                        <button type="button" class="btn btn-outline-success btn-block" style="font-size: 15px;"
                                            data-toggle="modal" data-toggle="modal" data-target="#AddModalCenter">เพิ่ม</button>
                                    </td> -->
                                </tr>
                                <% } %>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </main>
    <!-- Essential javascripts for application to work-->
    <script src="js/jquery-3.2.1.min.js"></script>
    <script src="js/popper.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/main.js"></script>

    <!-- The javascript plugin to display page loading on top-->
    <script src="js/plugins/pace.min.js"></script>
    <!-- Page specific javascripts-->
    <!-- Data table plugin-->
    <script type="text/javascript" src="js/plugins/jquery.dataTables.min.js"></script>
    <script type="text/javascript" src="js/plugins/dataTables.bootstrap.min.js"></script>
    <script type="text/javascript">
        $('#sampleTable').DataTable();

        function deletePerson(id) {
            $.ajax({
                type: "delete",
                url: "/mangeperson",
                data: {
                    id: id
                },
                dataType: "json",
                success: () => {
                    window.location.reload()
                }
            })
        }

        var editPerson  = () => {  
            console.log("ssf");
              
            var data = {
                id: $('#editid').val(),
                username: $('#editusername').val(),
                password: $('#editpassword').val(),
                firstname: $('#editfirstname').val(),
                lastname: $('#editlastname').val(),
                email: $('#editemail').val(),
                status: $('#editstatus').val(),
                position: $('#editposition').val()
            }    
            $.ajax({
                type: "put",
                url: "/mangeperson",
                data: data,
                dataType: "json",
                success: () => {
                    window.location.reload()
                }
            })
        }

        var feedPerson = (id, username, password, firstname, lastname, email, status, position) => {
            id: $('#editid').val(id)
            username: $('#editusername').val(username)
            password: $('#editpassword').val(password)
            firstname: $('#editfirstname').val(firstname)
            lastname: $('#editlastname').val(lastname)
            email: $('#editemail').val(email)
            status: $('#editstatus').val(status)
            position: $('#editposition').val(position)
        }

        function addOfficial() {
            var jsonData = {
                id: $('#id').val(),
                username: $('#username').val(),
                password: $('#password').val(),
                firstname: $('#firstname').val(),
                lastname: $('#lastname').val(),
                email: $('#email').val(),
                status: $('#status').val(),
                position: $('#position').val()
            }
            console.log(jsonData);

            $.ajax({
                type: "post",
                url: "/mangeperson",
                data: {
                    id: $('#id').val(),
                    username: $('#username').val(),
                    password: $('#password').val(),
                    firstname: $('#firstname').val(),
                    lastname: $('#lastname').val(),
                    email: $('#email').val(),
                    status: $('#status').val(),
                    position: $('#position').val()
                },
                dataType: "json",
                success: () => {
                    window.location.reload()
                }
            })
        }
    </script>
</body>

</html>